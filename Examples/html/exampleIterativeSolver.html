<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>Iterative Solver Example</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S1 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S2 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S4 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.eoOutputWrapper { width: calc(90vw - 10px) !important; }
.S6 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsErrorElement .diagnosticMessage-errorType {    overflow: auto;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent button {    user-select: none;    -webkit-user-select: none;}
.embeddedOutputsErrorElement .eoOutputContent ::selection {}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsWarningElement .diagnosticMessage-warningType {    overflow: auto;}
.embeddedOutputsWarningElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsWarningElement .eoOutputContent ::selection {}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2023 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: var(--mw-color-matlabWarning) !important;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: var(--mw-color-matlabErrors) !important;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 550px;}
.embeddedOutputsTextElement .textElement,.embeddedOutputsVariableStringElement .textElement {    overflow: auto;}
.embeddedOutputsTextElement.activeOutput .eoOutputContent,.embeddedOutputsVariableStringElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
/*embeddedOutputsTextElement has a different dom structure than embeddedOutputsVariableStringElement.Unlike variableString, the text output has both TEXT nodes and elements as children. Hence we needa selector for each.*/.embeddedOutputsTextElement .eoOutputContent::selection,.embeddedOutputsTextElement .eoOutputContent ::selection,.embeddedOutputsVariableStringElement .eoOutputContent ::selection {}
.textElement,.rtcDataTipElement .textElement {    padding-top: 2px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Iterative Solver Example</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >clc; clear; close </span><span style="color: rgb(167, 9, 245);">all</span><span >;</span></span></div></div></div><h2  class = 'S2'><span>Data Description</span></h2><div  class = 'S3'><span>This is a 5d example. The number of points in the grid is 117,600. This means that the rank of the linear system equations solved is 117,600. I would classify this as a medium size problem. In my experiments, MATLAB is using 3500MB of RAM at just before regularizeNd tries to solve the system of linear equations. The direct solvers ('\' and 'normal') both fail because of a bug in MATLAB 2016b x64. It turns out this is a bug in the underlying libraries. With the same A and b matrices in the Julia Language, I get the same errors. Therefore, the direct solvers are not usuable currently with this problem. In future versions of MATLAB, I would expect this gets fixed but who knows when. I wrote this on 2017-Nov-17.</span></div><div  class = 'S3'><span style=' font-weight: bold;'>Update 2019-Jan-15</span></div><div  class = 'S3'><span>The direct solver no longer run out of memory as of 2018b but instead lock up the computer! 2019-Jan-15. This is bad. Therefore, the code is commented out.</span></div><div  class = 'S3'><span style=' font-weight: bold;'>Update 2020-July-16</span></div><div  class = 'S3'><span>In 2020b this example runs without error. Maximum memory request was higher than the 32GB on my computer but it did not stop the solvers. The 'normal' solver is 10x faster than the '\' solver. The iterative 'pcg' and 'symmlq' solvers have the advantage because they are more than 12x faster than the 'normal'. The 'lsqr' is still the last resort if the 'pcg' or 'symmlq' fail. </span></div><div  class = 'S3'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >load(</span><span style="color: rgb(167, 9, 245);">'Iterative Solver Data.mat'</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>Try the Direct Solvers</span></h2><div  class = 'S3'><span>Try the 'normal' solver. This will throw an error as of MATLAB 2016b x64. In future versions of MATLAB, this error may or may not be an error.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >smoothness = [0.001 0.01 0.01 0.001 0.01];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >interpMethod = </span><span style="color: rgb(167, 9, 245);">"linear"</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">try</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    tic;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    [~] = regularizeNd(inputs, output, xGrid, smoothness);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% Note this call is the same as</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% yGrid = regularizeNd(inputs, output, xGrid, smoothness,'linear', 'normal');</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    fprintf(</span><span style="color: rgb(167, 9, 245);">'No error thrown. Mathworks fixed this bug.\n'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    toc;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">catch </span><span >exception</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >   fprintf([</span><span style="color: rgb(167, 9, 245);">'While using the ''normal'' solver in regularizeNd,\n' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >       </span><span style="color: rgb(167, 9, 245);">'MATLAB threw the following error:\n%s\n%s\n\n'</span><span >], exception.identifier, exception.message);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="5EF5FA66" prevent-scroll="true" data-testid="output_0" tabindex="-1" style="width: 1157px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class=" textElement eoOutputContent" tabindex="-1" data-previous-available-width="1120" data-previous-scroll-height="17" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">No error thrown. Mathworks fixed this bug.</div></div><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="CF83E0D3" prevent-scroll="true" data-testid="output_1" tabindex="-1" style="width: 1157px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class=" textElement eoOutputContent" tabindex="-1" data-previous-available-width="1120" data-previous-scroll-height="17" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">Elapsed time is 930.022098 seconds.</div></div></div></div></div><div  class = 'S3'><span>Try the '\' solver. This will throw an error as of MATLAB 2016b x64. In future versions of MATLAB, this error may or may not be an error.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">try</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    tic;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    [~] = regularizeNd(inputs, output, xGrid, smoothness, interpMethod,</span><span style="color: rgb(167, 9, 245);">'\'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    fprintf(</span><span style="color: rgb(167, 9, 245);">'No error thrown. Mathworks fixed this bug.\n'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    toc;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">catch </span><span >exception</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >      fprintf([</span><span style="color: rgb(167, 9, 245);">'While using the ''\\'' solver in regularizeNd,\n' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >       </span><span style="color: rgb(167, 9, 245);">'MATLAB threw the following error:\n%s\n%s\n'</span><span >], exception.identifier, exception.message);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="B4A965E7" prevent-scroll="true" data-testid="output_2" tabindex="-1" style="width: 1157px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class=" textElement eoOutputContent" tabindex="-1" data-previous-available-width="1120" data-previous-scroll-height="17" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">No error thrown. Mathworks fixed this bug.</div></div><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="09650732" prevent-scroll="true" data-testid="output_3" tabindex="-1" style="width: 1157px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class=" textElement eoOutputContent" tabindex="-1" data-previous-available-width="1120" data-previous-scroll-height="17" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">Elapsed time is 8266.395394 seconds.</div></div></div></div></div><h2  class = 'S2'><span>Try the Iterative Solvers</span></h2><div  class = 'S3'><span>Solve using the 'pcg' solver. The pcg solver solves the normal equation iteratively for x, (A'*A)*x = A'*b. Note that the condition number of (A'*A) is square of the condition number of A. This means that solving the problem is more numerically unstable than solving A*x = b in the least squares sense. However, regularizeNd generally produces well conditioned matrices so this issue is most often irrelevant. If you need an iterative solver and are struggling with accuracy, try 'lsqr'.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >tic;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >[~] = regularizeNd(inputs, output, xGrid, smoothness, interpMethod, </span><span style="color: rgb(167, 9, 245);">'pcg'</span><span >);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >toc;</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="3A2EC35D" prevent-scroll="true" data-testid="output_4" tabindex="-1" style="width: 1157px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class=" textElement eoOutputContent" tabindex="-1" data-previous-available-width="1120" data-previous-scroll-height="17" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">Elapsed time is 53.382053 seconds.</div></div></div></div></div><div  class = 'S3'><span>Solving using the 'symmlq' solver. The symmlq solver is very similar to the pcg solver; see the MATLAB documentation to see the similarities. The similarities between the solvers are beyond the scope of this example. The symmlq solver solves the normal equation iteratively for x, (A'*A)*x = A'*b.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >tic;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >[~] = regularizeNd(inputs, output, xGrid, smoothness, interpMethod, </span><span style="color: rgb(167, 9, 245);">'symmlq'</span><span >);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >toc;</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="16C1FB08" prevent-scroll="true" data-testid="output_5" tabindex="-1" style="width: 1157px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class=" textElement eoOutputContent" tabindex="-1" data-previous-available-width="1120" data-previous-scroll-height="17" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">Elapsed time is 52.895435 seconds.</div></div></div></div></div><div  class = 'S3'><span>Solving using the 'lsqr' solver. The lsqr solver solves A*x = b in the least squares sense iteratively. Use this solver as a last resort with regularizeNd. There is probably a rare case where '\' and 'normal' fail, and 'pcg' and 'symmlq' do not produce adequate results. Thus, lsqr would be the last resort and may produce adequately accurate results at the cost of long solve times.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >tic;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >[~] = regularizeNd(inputs, output, xGrid, smoothness, interpMethod, </span><span style="color: rgb(167, 9, 245);">'lsqr'</span><span >);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >toc;</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="DDA4E10D" prevent-scroll="true" data-testid="output_6" tabindex="-1" style="width: 1157px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class=" textElement eoOutputContent" tabindex="-1" data-previous-available-width="1120" data-previous-scroll-height="17" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">Elapsed time is 377.954214 seconds.</div></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Iterative Solver Example

clc; clear; close all;
%% Data Description
% This is a 5d example. The number of points in the grid is 117,600. This means 
% that the rank of the linear system equations solved is 117,600. I would classify 
% this as a medium size problem. In my experiments, MATLAB is using 3500MB of 
% RAM at just before regularizeNd tries to solve the system of linear equations. 
% The direct solvers ('\' and 'normal') both fail because of a bug in MATLAB 2016b 
% x64. It turns out this is a bug in the underlying libraries. With the same A 
% and b matrices in the Julia Language, I get the same errors. Therefore, the 
% direct solvers are not usuable currently with this problem. In future versions 
% of MATLAB, I would expect this gets fixed but who knows when. I wrote this on 
% 2017-Nov-17.
% 
% *Update 2019-Jan-15*
% 
% The direct solver no longer run out of memory as of 2018b but instead lock 
% up the computer! 2019-Jan-15. This is bad. Therefore, the code is commented 
% out.
% 
% *Update 2020-July-16*
% 
% In 2020b this example runs without error. Maximum memory request was higher 
% than the 32GB on my computer but it did not stop the solvers. The 'normal' solver 
% is 10x faster than the '\' solver. The iterative 'pcg' and 'symmlq' solvers 
% have the advantage because they are more than 12x faster than the 'normal'. 
% The 'lsqr' is still the last resort if the 'pcg' or 'symmlq' fail. 
% 
% 

load('Iterative Solver Data.mat');
%% Try the Direct Solvers
% Try the 'normal' solver. This will throw an error as of MATLAB 2016b x64. 
% In future versions of MATLAB, this error may or may not be an error.

smoothness = [0.001 0.01 0.01 0.001 0.01];
interpMethod = "linear";

try
    tic;
    [~] = regularizeNd(inputs, output, xGrid, smoothness);
    % Note this call is the same as
    % yGrid = regularizeNd(inputs, output, xGrid, smoothness,'linear', 'normal');
    
    fprintf('No error thrown. Mathworks fixed this bug.\n');
    toc;
catch exception
   fprintf(['While using the ''normal'' solver in regularizeNd,\n' ...
       'MATLAB threw the following error:\n%s\n%s\n\n'], exception.identifier, exception.message);
end
%% 
% Try the '\' solver. This will throw an error as of MATLAB 2016b x64. In future 
% versions of MATLAB, this error may or may not be an error.

try
    tic;
    [~] = regularizeNd(inputs, output, xGrid, smoothness, interpMethod,'\');
    
    fprintf('No error thrown. Mathworks fixed this bug.\n');
    toc;
catch exception
      fprintf(['While using the ''\\'' solver in regularizeNd,\n' ...
       'MATLAB threw the following error:\n%s\n%s\n'], exception.identifier, exception.message);
end
%% Try the Iterative Solvers
% Solve using the 'pcg' solver. The pcg solver solves the normal equation iteratively 
% for x, (A'*A)*x = A'*b. Note that the condition number of (A'*A) is square of 
% the condition number of A. This means that solving the problem is more numerically 
% unstable than solving A*x = b in the least squares sense. However, regularizeNd 
% generally produces well conditioned matrices so this issue is most often irrelevant. 
% If you need an iterative solver and are struggling with accuracy, try 'lsqr'.

tic;
[~] = regularizeNd(inputs, output, xGrid, smoothness, interpMethod, 'pcg');
toc;
%% 
% Solving using the 'symmlq' solver. The symmlq solver is very similar to the 
% pcg solver; see the MATLAB documentation to see the similarities. The similarities 
% between the solvers are beyond the scope of this example. The symmlq solver 
% solves the normal equation iteratively for x, (A'*A)*x = A'*b.

tic;
[~] = regularizeNd(inputs, output, xGrid, smoothness, interpMethod, 'symmlq');
toc;
%% 
% Solving using the 'lsqr' solver. The lsqr solver solves A*x = b in the least 
% squares sense iteratively. Use this solver as a last resort with regularizeNd. 
% There is probably a rare case where '\' and 'normal' fail, and 'pcg' and 'symmlq' 
% do not produce adequate results. Thus, lsqr would be the last resort and may 
% produce adequately accurate results at the cost of long solve times.

tic;
[~] = regularizeNd(inputs, output, xGrid, smoothness, interpMethod, 'lsqr');
toc;
##### SOURCE END #####
-->
</div></body></html>